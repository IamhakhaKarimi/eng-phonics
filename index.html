<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phonics Fun - Digraphs & Trigraphs</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #FFD166 0%, #EF476F 80%, #06D6A0 90%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 2.5rem;
            color: #2d3748;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #4a5568;
            margin-bottom: 20px;
        }

        .controls-container {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            flex-wrap: wrap;
            justify-content: center;
            max-width: 1200px;
            width: 100%;
        }

        .dropdown-container {
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            flex: 1;
            min-width: 250px;
            max-width: 400px;
        }

        .name-picker-container {
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            flex: 2;
            min-width: 500px;
        }

        .dropdown-label, .name-picker-label {
            font-size: 1.3rem;
            color: #2d3748;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .dropdown-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        select {
            font-size: 1.2rem;
            padding: 12px 20px;
            border: 3px solid #4299e1;
            border-radius: 15px;
            background: white;
            color: #2d3748;
            cursor: pointer;
            flex: 1;
            font-family: inherit;
        }

        select:focus {
            outline: none;
            border-color: #3182ce;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
        }

        .random-sound-button {
            padding: 12px 20px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            white-space: nowrap;
            width: 100%;
        }

        .random-sound-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .name-input {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 3px solid #4299e1;
            border-radius: 15px;
            font-size: 1.1rem;
            font-family: 'Quicksand', sans-serif;
            resize: vertical;
            margin-bottom: 15px;
        }

        .name-input:focus {
            outline: none;
            border-color: #3182ce;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
        }

        .pick-student-button {
            width: 100%;
            padding: 12px 20px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #10ac84 0%, #00d2d3 100%);
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            margin-bottom: 15px;
        }

        .pick-student-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 172, 132, 0.4);
        }

        .selected-student {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: bold;
            font-family: 'Quicksand', sans-serif;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.5s ease;
        }

        .rolling-animation {
            animation: roll 2.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes roll {
            0% { 
                transform: translateY(0) scale(1) rotateX(0deg);
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            }
            20% { 
                transform: translateY(-15px) scale(1.05) rotateX(10deg);
                background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                box-shadow: 0 8px 25px rgba(240, 147, 251, 0.6);
            }
            40% { 
                transform: translateY(8px) scale(0.95) rotateX(-5deg);
                background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
                box-shadow: 0 6px 20px rgba(255, 107, 107, 0.5);
            }
            60% { 
                transform: translateY(-8px) scale(1.02) rotateX(8deg);
                background: linear-gradient(135deg, #10ac84 0%, #00d2d3 100%);
                box-shadow: 0 10px 30px rgba(16, 172, 132, 0.6);
            }
            80% { 
                transform: translateY(3px) scale(0.98) rotateX(-3deg);
                background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
                box-shadow: 0 5px 18px rgba(255, 216, 155, 0.5);
            }
            100% { 
                transform: translateY(0) scale(1) rotateX(0deg);
                background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
                box-shadow: 0 8px 25px rgba(46, 204, 113, 0.4);
            }
        }

        .final-selection {
            animation: finalGlow 1s ease-out;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%) !important;
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(46, 204, 113, 0.8), 0 0 60px rgba(46, 204, 113, 0.4) !important;
        }

        @keyframes finalGlow {
            0% { 
                transform: scale(1.1);
                box-shadow: 0 0 40px rgba(46, 204, 113, 1);
            }
            50% { 
                transform: scale(1.15);
                box-shadow: 0 0 50px rgba(46, 204, 113, 0.9);
            }
            100% { 
                transform: scale(1.05);
                box-shadow: 0 0 30px rgba(46, 204, 113, 0.8), 0 0 60px rgba(46, 204, 113, 0.4);
            }
        }

        .word-display {
            text-align: center;
            background: white;
            padding: 40px;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            max-width: 600px;
            width: 100%;
        }

        .word {
            font-size: 4rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 20px;
            letter-spacing: 8px;
            text-transform: lowercase;
        }

        .phoneme-indicators {
            font-size: 2rem;
            color: #e53e3e;
            letter-spacing: 8px;
            font-weight: bold;
            margin-top: 10px;
        }

        .instruction {
            font-size: 1.1rem;
            color: #718096;
            font-style: italic;
            margin-top: 20px;
        }

        .sound-highlight {
            background: linear-gradient(120deg, #ffd89b 0%, #19547b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .button-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .action-button {
            padding: 12px 20px;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
            justify-content: center;
        }

        .shuffle-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .shuffle-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .pronounce-button {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(240, 147, 251, 0.4);
        }

        .pronounce-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(240, 147, 251, 0.6);
        }

        .button-disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }
            
            .word {
                font-size: 2.5rem;
                letter-spacing: 4px;
            }
            
            .phoneme-indicators {
                font-size: 1.5rem;
                letter-spacing: 4px;
            }
            
            select {
                min-width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1 class="title">🎵 Phonics Fun! 🎵</h1>
        <p class="subtitle">Learn digraphs and trigraphs with visual phoneme markers</p>
    </div>

    <div class="controls-container">
        <div class="dropdown-container">
            <label class="dropdown-label" for="soundSelect">Choose a sound:</label>
            <div class="dropdown-column">
                <select id="soundSelect">
                    <option value="">Select digraphs...</option>
                    <!-- Options will be inserted here by JS -->
                </select>
                <button class="random-sound-button" id="randomSoundButton">🎲 Random Sound</button>
            </div>
        </div>

        <div class="name-picker-container">
            <label class="name-picker-label" for="nameInput">Student Names:</label>
            <textarea 
                id="nameInput" 
                class="name-input" 
                placeholder="Enter student names, one per line:&#10;Emma&#10;Liam&#10;Sophia&#10;Noah&#10;Olivia"
            ></textarea>
            <button class="pick-student-button" id="pickStudentButton">🎯 Pick a Student</button>
            <div class="selected-student" id="selectedStudent">
                "Enter names on the list."
            </div>
        </div>
    </div>

    <div class="word-display">
        <div class="word" id="wordDisplay">Choose a sound above! 👆</div>
        <div class="phoneme-indicators" id="phonemeDisplay"></div>
        <div class="instruction" id="instructionText">Select a digraph to see a word and its phoneme breakdown</div>
        <div class="button-container">
            <button class="action-button shuffle-button button-disabled" id="shuffleButton">
                🔀 New Word
            </button>
            <button class="action-button pronounce-button button-disabled" id="pronounceButton">
                🔊 Say Word
            </button>
        </div>
    </div>

    <script>
        // Extended word options (15 words per sound)
        const wordMap = {
            'sh': ['ship', 'shop', 'fish', 'wash', 'shell', 'sheep', 'shoe', 'brush', 'crash', 'splash', 'mushroom', 'shut', 'shine', 'shock', 'cash'],
            'ch': ['chair', 'chip', 'much', 'lunch', 'cheese', 'chase', 'child', 'church', 'bench', 'fetch', 'cherry', 'chocolate', 'check', 'chick', 'hatch'],
            'th': ['bath', 'think', 'three', 'tooth', 'thumb', 'thick', 'thank', 'thread', 'throat', 'earth', 'thunder', 'path', 'math', 'thief', 'smooth'],
            'wh': ['whale', 'wheel', 'white', 'when', 'where', 'which', 'whip', 'while', 'wheat', 'whisper', 'whisk', 'whistle', 'wheelbarrow', 'wheelchair', 'whirl'],
            'ph': ['phone', 'photo', 'graph', 'laugh', 'elephant', 'alphabet', 'phrase', 'physics', 'phantom', 'pharmacy', 'dolphin', 'photograph', 'sophisticated', 'phrasebook', 'phantasy'],
            'ng': ['ring', 'sing', 'long', 'king', 'strong', 'wing', 'bang', 'song', 'tongue', 'hanging', 'young', 'morning', 'evening', 'sponge', 'finger'],
            'ck': ['duck', 'back', 'rock', 'quick', 'truck', 'click', 'clock', 'pack', 'sock', 'neck', 'peck', 'track', 'snack', 'stick', 'crack'],
            'kn': ['knee', 'know', 'knife', 'knock', 'knot', 'knit', 'knight', 'knob', 'knowledge', 'knuckle', 'knapsack', 'knead', 'knacker', 'kneel', 'knurled'],
            'wr': ['wrap', 'write', 'wrong', 'wrist', 'wreck', 'wrench', 'wrestle', 'wrinkle', 'wriggle', 'wring', 'wrote', 'written', 'wry', 'writ', 'wryness'],
            'ai': ['rain', 'mail', 'pain', 'train', 'brain', 'tail', 'nail', 'sail', 'fail', 'jail', 'wait', 'paid', 'maid', 'bait', 'gait'],
            'ay': ['day', 'play', 'say', 'way', 'may', 'stay', 'pray', 'tray', 'spray', 'delay', 'relay', 'clay', 'bay', 'slay', 'fray'],
            'ee': ['see', 'tree', 'meet', 'bee', 'green', 'sleep', 'feet', 'sheep', 'keep', 'deep', 'sweet', 'seed', 'beet', 'cheese', 'jeep'],
            'ea_long': ['eat', 'sea', 'read', 'leaf', 'beach', 'meat', 'seat', 'deal', 'team', 'dream', 'scream', 'peach', 'reach', 'steal', 'heal'],
            'ea_short': ['head', 'bread', 'ready', 'heavy', 'weather', 'dead', 'spread', 'thread', 'breath', 'health', 'sweat', 'threat', 'wealth', 'weapon', 'sweater'],
            'ie': ['pie', 'die', 'tie', 'lie', 'cries', 'thief', 'field', 'brief', 'chief', 'piece', 'shield', 'grief', 'belief', 'niece', 'fiend'],
            'ei': ['eight', 'vein', 'neighbor', 'weigh', 'sleigh', 'reign', 'freight', 'deceive', 'perceive', 'ceiling', 'receive', 'weird', 'height', 'either', 'neither'],
            'ey': ['they', 'grey', 'key', 'honey', 'money', 'donkey', 'valley', 'monkey', 'survey', 'journey', 'prey', 'hey', 'obey', 'delay', 'greyhound'],
            'oa': ['boat', 'coat', 'soap', 'road', 'goat', 'float', 'coach', 'oak', 'toast', 'groan', 'roast', 'moat', 'throat', 'coast', 'poach'],
            'ow_long': ['snow', 'know', 'grow', 'show', 'blow', 'bow', 'throw', 'flow', 'glow', 'mow', 'row', 'stow', 'crow', 'plow', 'sow'],
            'ow_short': ['cow', 'town', 'now', 'brown', 'down', 'how', 'coward', 'frown', 'crown', 'plow', 'scowl', 'vowel', 'towel', 'powder', 'tower'],
            'ou_short': ['out', 'house', 'shout', 'loud', 'cloud', 'mouse', 'mouth', 'round', 'found', 'ground', 'proud', 'south', 'route', 'trout', 'clout'],
            'ou_schwa': ['cousin', 'double', 'trouble', 'country', 'young', 'couple', 'puzzle', 'bubble', 'cuddle', 'supple', 'ruffle', 'struggle', 'tumble', 'muffle', 'muddle'],
            'oo_long': ['moon', 'food', 'boot', 'cool', 'school', 'zoo', 'pool', 'spoon', 'room', 'bamboo', 'toon', 'gloom', 'broom', 'loot', 'swoop'],
            'oo_short': ['book', 'foot', 'look', 'good', 'wood', 'hood', 'stood', 'wool', 'hook', 'cook', 'brook', 'crook', 'soot', 'hoop', 'rook'],
            'ue': ['blue', 'true', 'clue', 'glue', 'value', 'rescue', 'continue', 'pursue', 'issue', 'due', 'cue', 'argue', 'subdue', 'venue', 'improve'],
            'ui': ['fruit', 'suit', 'juice', 'build', 'guitar', 'ruin', 'guilt', 'guide', 'quiet', 'fluid', 'suitcase', 'bruise', 'suite', 'cruise', 'ruined'],
            'au': ['caught', 'author', 'fault', 'sauce', 'because', 'audience', 'august', 'launch', 'applause', 'haunt', 'taught', 'naughty', 'daughter', 'pause', 'autumn'],
            'aw': ['saw', 'law', 'draw', 'paw', 'straw', 'claw', 'yawn', 'lawn', 'flaw', 'jaw', 'raw', 'sawdust', 'strawberry', 'withdraw', 'drawback'],
            'oi': ['coin', 'oil', 'soil', 'boil', 'point', 'voice', 'noise', 'choice', 'toilet', 'join', 'destroy', 'boisterous', 'ointment', 'spoiled', 'avoid'],
            'oy': ['boy', 'toy', 'enjoy', 'royal', 'destroy', 'oyster', 'voyage', 'loyal', 'annoy', 'deploy', 'employ', 'rejoice', 'joyful', 'joyous', 'enjoyment'],
            'eu': ['feud', 'neutral', 'Europe', 'pneumonia', 'sleuth', 'euphemism', 'eulogy', 'euphoria', 'euphemistic', 'eunuch', 'feudal', 'neuro', 'neuron', 'pneumatic', 'pseudo'],
            'ew': ['few', 'new', 'grew', 'threw', 'screw', 'dew', 'chew', 'blew', 'flew', 'grew', 'stew', 'review', 'dewdrop', 'grewth', 'threwing'],
            'tch': ['catch', 'match', 'switch', 'watch', 'kitchen', 'batch', 'patch', 'hatch', 'latch', 'scratch', 'pitch', 'itch', 'fetch', 'stretch', 'witch'],
            'dge': ['badge', 'edge', 'bridge', 'judge', 'fridge', 'ledge', 'hedge', 'smudge', 'nudge', 'dredge', 'budge', 'fudge', 'splodge', 'knowledge', 'bridge'],
            'igh': ['high', 'light', 'night', 'right', 'bright', 'fight', 'sight', 'tight', 'flight', 'might', 'sigh', 'sign', 'climb', 'design', 'align'],
            'eigh': ['eight', 'weigh', 'neighbor', 'sleigh', 'freight', 'reign', 'vein', 'deceive', 'seize', 'heir', 'weight', 'freight', 'reweigh', 'sleight', 'height'],
            'ough_though': ['though', 'dough', 'thorough', 'borough', 'furlough', 'although', 'through', 'cough', 'rough', 'tough', 'thought', 'bought', 'fought', 'brought', 'sought'],
            'ough_cough': ['cough', 'rough', 'tough', 'enough', 'trough', 'plough', 'dough', 'though', 'through', 'thorough', 'buffalo', 'hiccup', 'stuff', 'gruff', 'ruff'],
            'augh_caught': ['caught', 'taught', 'daughter', 'naughty', 'slaughter', 'haughty', 'aught', 'bought', 'fought', 'thought', 'nought', 'fraught', 'taught', 'aught', 'draught'],
            'augh_laugh': ['laugh', 'laughter', 'draught', 'staff', 'half', 'calf', 'chaff', 'graft', 'shaft', 'bath', 'path', 'fast', 'last', 'pass', 'grass'],
            'ought': ['thought', 'bought', 'brought', 'fought', 'sought', 'caught', 'taught', 'nought', 'fraught', 'aught', 'haughty', 'daught', 'brought', 'fought', 'sought'],
            'ight': ['night', 'light', 'fight', 'sight', 'flight', 'right', 'tight', 'bright', 'knight', 'might', 'sight', 'plight', 'flight', 'fright', 'height'],
            'ear_hear': ['hear', 'clear', 'dear', 'fear', 'year', 'near', 'tear', 'appear', 'rear', 'steer', 'beer', 'cheer', 'sphere', 'career', 'severe'],
            'ear_earth': ['earth', 'learn', 'search', 'heard', 'pearl', 'early', 'earn', 'search', 'hearth', 'yearn', 'earthquake', 'earnest', 'hearsay', 'learned', 'research'],
            'eir': ['their', 'heir', 'weird', 'seize', 'receive', 'deceive', 'conceit', 'ceiling', 'neither', 'either', 'feisty', 'heirloom', 'weirdo', 'conceited', 'deceit'],
            'air': ['hair', 'fair', 'pair', 'chair', 'stair', 'bear', 'care', 'dare', 'glare', 'stare', 'share', 'rare', 'scare', 'flare', 'despair'],
            'are': ['care', 'share', 'dare', 'square', 'prepare', 'rare', 'scare', 'aware', 'declare', 'compare', 'repair', 'bare', 'fare', 'hare', 'there'],
            'ore': ['more', 'store', 'shore', 'before', 'explore', 'score', 'roar', 'board', 'floor', 'door', 'pour', 'four', 'snore', 'snore', 'restore'],
            'ure': ['pure', 'sure', 'cure', 'nature', 'picture', 'future', 'adventure', 'failure', 'measure', 'pleasure', 'exposure', 'closure', 'endure', 'secure', 'mature'],
            'ieu': ['adieu', 'lieu', 'milieu', 'queue', 'view', 'review', 'interview', 'subterfuge', 'paparazzi', 'statue', 'ambiguity', 'solitude', 'gratitude', 'attitude', 'fortitude']
        };

        // Sort keys alphabetically by display label
        const soundLabels = {
            'sh': 'sh',
            'ch': 'ch',
            'th': 'th',
            'wh': 'wh',
            'ph': 'ph',
            'ng': 'ng',
            'ck': 'ck',
            'kn': 'kn',
            'wr': 'wr',
            'ai': 'ai',
            'ay': 'ay',
            'ee': 'ee',
            'ea_long': 'ea (long)',
            'ea_short': 'ea (short)',
            'ie': 'ie',
            'ei': 'ei',
            'ey': 'ey',
            'oa': 'oa',
            'ow_long': 'ow (long)',
            'ow_short': 'ow (short)',
            'ou_short': 'ou (short)',
            'ou_schwa': 'ou (schwa)',
            'oo_long': 'oo (long)',
            'oo_short': 'oo (short)',
            'ue': 'ue',
            'ui': 'ui',
            'au': 'au',
            'aw': 'aw',
            'oi': 'oi',
            'oy': 'oy',
            'eu': 'eu',
            'ew': 'ew',
            'tch': 'tch',
            'dge': 'dge',
            'igh': 'igh',
            'eigh': 'eigh',
            'ough_though': 'ough (as in "though")',
            'ough_cough': 'ough (as in "cough")',
            'augh_caught': 'augh (as in "caught")',
            'augh_laugh': 'augh (as in "laugh")',
            'ought': 'ought',
            'ight': 'ight',
            'ear_hear': 'ear (as in "hear")',
            'ear_earth': 'ear (as in "earth")',
            'eir': 'eir',
            'air': 'air',
            'are': 'are',
            'ore': 'ore',
            'ure': 'ure',
            'ieu': 'ieu'
        };

        const sortedSounds = Object.keys(soundLabels).sort((a, b) => {
            return soundLabels[a].localeCompare(soundLabels[b]);
        });

        // Populate dropdown
        const soundSelect = document.getElementById('soundSelect');
        sortedSounds.forEach(key => {
            const option = document.createElement('option');
            option.value = key;
            option.textContent = soundLabels[key];
            soundSelect.appendChild(option);
        });

        // Keep track of current word index for each sound
        let currentWordIndex = {};

        // All digraphs and trigraphs for recognition
        const sounds = ['sh', 'ch', 'th', 'wh', 'ph', 'ng', 'ck', 'kn', 'wr', 'ai', 'ay', 'ee', 'ea', 'ie', 'ei', 'ey', 'oa', 'ow', 'ou', 'oo', 'ue', 'ui', 'au', 'aw', 'oi', 'oy', 'eu', 'ew', 'tch', 'dge', 'igh', 'eigh', 'ough', 'augh', 'ought', 'ight', 'ear', 'eir', 'air', 'are', 'ore', 'ure', 'ieu'];

        function generatePhonemeMarkers(word, targetSound) {
            let markers = '';
            let i = 0;
            
            // Clean target sound for matching
            let cleanTargetSound = targetSound.replace('_though', '').replace('_cough', '').replace('_caught', '').replace('_laugh').replace('_long', '').replace('_short', '').replace('_schwa', '').replace('_hear', '').replace('_earth');
            
            while (i < word.length) {
                let found = false;
                
                // Check for trigraphs first (longest matches first)
                for (let len = 4; len >= 2; len--) {
                    if (i + len <= word.length) {
                        let substring = word.substring(i, i + len);
                        if (sounds.includes(substring) || substring === cleanTargetSound) {
                            // Add dashes for digraph/trigraph
                            for (let j = 0; j < len; j++) {
                                markers += '–';
                            }
                            markers += ' ';
                            i += len;
                            found = true;
                            break;
                        }
                    }
                }
                
                // If no digraph/trigraph found, add dot for single letter
                if (!found) {
                    markers += '• ';
                    i++;
                }
            }
            
            return markers.trim();
        }

        let currentSound = '';

        function getRandomWord(selectedSound) {
            if (!wordMap[selectedSound]) return null;
            
            const words = wordMap[selectedSound];
            if (!currentWordIndex[selectedSound]) {
                currentWordIndex[selectedSound] = 0;
            }
            
            // Get current word and increment index
            const word = words[currentWordIndex[selectedSound]];
            currentWordIndex[selectedSound] = (currentWordIndex[selectedSound] + 1) % words.length;
            
            return word;
        }

        function shuffleWord() {
            if (!currentSound) return;
            displayWord(currentSound, true);
        }

        function pronounceWord() {
            const wordDisplay = document.getElementById('wordDisplay');
            const word = wordDisplay.textContent;
            
            if (word && word !== 'Choose a sound above! 👆') {
                // Use Web Speech API to pronounce the word
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(word);
                    utterance.rate = 0.8;
                    utterance.pitch = 1.1;
                    utterance.volume = 1;
                    speechSynthesis.speak(utterance);
                }
            }
        }

        function updateButtonStates(hasWord) {
            const shuffleButton = document.getElementById('shuffleButton');
            const pronounceButton = document.getElementById('pronounceButton');
            
            if (hasWord) {
                shuffleButton.classList.remove('button-disabled');
                pronounceButton.classList.remove('button-disabled');
            } else {
                shuffleButton.classList.add('button-disabled');
                pronounceButton.classList.add('button-disabled');
            }
        }

        function displayWord(selectedSound, isShuffling = false) {
            const wordDisplay = document.get
